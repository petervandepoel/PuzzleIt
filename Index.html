<html>
<head>

<script src="http://code.jquery.com/jquery-1.9.1.js"></script>
<script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
<script src="jquery.ui.touch-punch.min.js"></script>
<style>

.droppable {
	position: relative;	
	z-index: -1;
}

.single-block {
	position: absolute;
	width: 30px;
	height: 30px;
	border-style: dashed;
	border-width: 1px;
	padding: 0px;
	margin: 0px; 
}

.game {
	position: relative;
}

.div {
	margin: 0px;
	padding: 0px;
}

</style>
<script>

$(document).ready(function() {

//set the draggable pieces
new pieces(1,"blue",1,1,"drag","master");
new pieces(1,"red",2,1,"drag");
new pieces(1,"red",3,1,"drag");
new pieces(1,"red",2,2,"drag");

new pieces(2,"blue",1,1,"drag","master");
new pieces(2,"yellow",2,0,"drag");
new pieces(2,"yellow",3,-1,"drag");

new pieces(3,"blue",1,2,"drag","master");
new pieces(3,"yellow",2,1,"drag");
new pieces(3,"yellow",2,2,"drag");
new pieces(3,"yellow",2,0,"drag");

new pieces(4,"blue",1,1,"drag","master");
new pieces(4,"green",1,2,"drag");
new pieces(4,"green",1,3,"drag");
new pieces(4,"green",2,3,"drag")
new pieces(4,"green",3,3,"drag")

//set the droppable pieces
new pieces(1,"grey",2,2,"drop");
new pieces(1,"grey",2,3,"drop");
new pieces(1,"grey",2,4,"drop");
new pieces(1,"grey",2,5,"drop");
new pieces(1,"grey",3,2,"drop");
new pieces(1,"grey",3,3,"drop");
new pieces(1,"grey",3,4,"drop");
new pieces(1,"grey",3,5,"drop");
new pieces(1,"grey",4,2,"drop");
new pieces(1,"grey",4,3,"drop");
new pieces(1,"grey",4,4,"drop");
new pieces(1,"grey",4,5,"drop");
new pieces(1,"grey",5,2,"drop");
new pieces(1,"grey",5,3,"drop");
new pieces(1,"grey",5,4,"drop");
new pieces(1,"grey",5,5,"drop");

});



function handleDropEvent(event, ui) {
	var x = $(this).offset().left;
	var y = $(this).offset().top;
	$(ui.draggable).offset({left:x,top:y});
};

function handleOverEvent(event,ui) {
	$(this).addClass("hover-background");
	console.log("Touched me!");
};

function handleOutEvent(event,ui) {
	$(this).removeClass("hover-background");
};


var pieces = function(id,color,x,y,behavior,master) {
	
	this.$piece = $('<div>');
	
	this.$piece.css({
		"left" : 30*(x-1) + "px",
		"top" : 30*(y-1) + "px",
		"background-color" : color,
		"z-index" : 5
	});
	
	if(behavior == "drag" && master == "master") { 
		this.$piece.css("top",(200+10*id) + "px");
		this.$piece.addClass('single-block').addClass('a'+id);
		$('div.game').append(this.$piece); 
		this.$piece.draggable(); }
	
	else if(behavior=="drag" && (!master || master == "slave")) {
		this.$piece.addClass('single-block');
		$('div.game div.single-block.a'+id).append(this.$piece); 
	}
	
	else if(behavior=="drop") {	
		this.$piece.addClass('single-block');
		$('.droppable').append(this.$piece);	
		this.$piece.droppable({
			drop: handleDropEvent,
			over: handleOverEvent,
			out: handleOutEvent
		});
	}
};




</script>
</head>
<body>

<div class="game"></div>
<div class="droppable">
</div>

</body>
</html>